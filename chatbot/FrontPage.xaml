<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="chatbot.FrontPage"
             BackgroundColor="#0F0F1E"
             xmlns:local="clr-namespace:chatbot">

    <Grid RowDefinitions="Auto,Auto,*">
        
        <!-- CabeÃ§alho com Gradiente -->
        <Frame Grid.Row="0"
               BackgroundColor="#1A1A2E"
               HasShadow="False"
               Padding="20,40,20,20"
               Margin="0">
            <VerticalStackLayout Spacing="10">
                <Label Text="ðŸ’¬ Minhas Conversas"
                       FontSize="32"
                       FontAttributes="Bold"
                       TextColor="White" />
                
                <Label Text="Selecione uma conversa para continuar"
                       FontSize="14"
                       TextColor="#B0B0B0" />
            </VerticalStackLayout>
        </Frame>

        <!-- BotÃµes de AÃ§Ã£o -->
        <Grid Grid.Row="1"
              ColumnDefinitions="*,*,*,*"
              ColumnSpacing="12"
              Padding="20,15,20,15"
              BackgroundColor="#0F0F1E">
            
            <Button Text="âž• Nova Conversa"
                    BackgroundColor="#4CAF50"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    Padding="15,12"
                    CornerRadius="15"
                    Clicked="OnStartChatClicked"
                    Grid.Column="0" />

            <Button Text="ðŸ”„ Atualizar"
                    BackgroundColor="#2196F3"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    Padding="15,12"
                    CornerRadius="15"
                    Clicked="OnLoadChatsClicked"
                    Grid.Column="1" />

           

            <Button Text="ðŸ“¥ Gerenciar"
                    BackgroundColor="#FF5722"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    Padding="15,12"
                    CornerRadius="15"
                    Clicked="OnOpenModelManagerClicked"
                    Grid.Column="2" />

            <Button Text="ðŸ“ Locais"
                    BackgroundColor="#607D8B"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    Padding="15,12"
                    CornerRadius="15"
                    Clicked="OnOpenLocalModelsClicked"
                    Grid.Column="3" />
        </Grid>

        <!-- Lista de Conversas com Scroll -->
        <ScrollView Grid.Row="2">
            <CollectionView ItemsSource="{Binding Conversations}"
                            SelectionChanged="OnChatSelected"
                            SelectionMode="Single"
                            BackgroundColor="Transparent">

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="20,8"
                              ColumnDefinitions="Auto,*,Auto"
                              ColumnSpacing="15">
                            
                            <!-- Ãcone do Chat -->
                            <Frame Grid.Column="0"
                                   WidthRequest="50"
                                   HeightRequest="50"
                                   CornerRadius="25"
                                   BackgroundColor="#2A2A3D"
                                   HasShadow="False"
                                   Padding="0">
                                <Label Text="ðŸ’¬"
                                       FontSize="24"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center" />
                            </Frame>

                            <!-- ConteÃºdo do Chat -->
                            <Frame Grid.Column="1"
                                   CornerRadius="15"
                                   Padding="15"
                                   Margin="0,0,0,10"
                                   BackgroundColor="#1E1E2E"
                                   HasShadow="True"
                                   BorderColor="#2A2A3D">
                                
                                <VerticalStackLayout Spacing="8">
                                    <!-- TÃ­tulo -->
                                    <Label Text="{Binding Title}"
                                           TextColor="White"
                                           FontSize="18"
                                           FontAttributes="Bold" />
                                    
                                    <!-- Preview da Ãºltima mensagem -->
                                    <Label Text="{Binding LastMessagePreview}"
                                           TextColor="#B0B0B0"
                                           FontSize="14"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="2" />
                                    
                                    <!-- InformaÃ§Ãµes adicionais -->
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Grid.Column="0"
                                               Text="{Binding MessageCount, StringFormat='{0} mensagens'}"
                                               TextColor="#808080"
                                               FontSize="12" />
                                        
                                        <Label Grid.Column="1"
                                               Text="â–¶"
                                               TextColor="#4CAF50"
                                               FontSize="16"
                                               VerticalOptions="Center" />
                                    </Grid>
                                </VerticalStackLayout>
                            </Frame>

                            <!-- BotÃµes de AÃ§Ã£o -->
                            <Grid Grid.Column="2"
                                  RowDefinitions="Auto,Auto"
                                  RowSpacing="8"
                                  VerticalOptions="Center">
                                
                                <!-- BotÃ£o Editar -->
                                <Button Text="âœï¸"
                                        BackgroundColor="#FF9800"
                                        TextColor="White"
                                        FontSize="16"
                                        WidthRequest="45"
                                        HeightRequest="45"
                                        CornerRadius="22"
                                        Padding="0"
                                        Clicked="OnEditChatClicked"
                                        CommandParameter="{Binding .}"
                                        Grid.Row="0" />
                                
                                <!-- BotÃ£o Deletar -->
                                <Button Text="ðŸ—‘ï¸"
                                        BackgroundColor="#F44336"
                                        TextColor="White"
                                        FontSize="16"
                                        WidthRequest="45"
                                        HeightRequest="45"
                                        CornerRadius="22"
                                        Padding="0"
                                        Clicked="OnDeleteChatClicked"
                                        CommandParameter="{Binding .}"
                                        Grid.Row="1" />
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

                <!-- Mensagem quando nÃ£o hÃ¡ chats -->
                <CollectionView.EmptyView>
                    <VerticalStackLayout HorizontalOptions="Center"
                                         VerticalOptions="Center"
                                         Spacing="20"
                                         Padding="40">
                        <Label Text="ðŸ’­"
                               FontSize="64"
                               HorizontalOptions="Center" />
                        <Label Text="Ainda nÃ£o tens conversas"
                               FontSize="18"
                               TextColor="#808080"
                               HorizontalOptions="Center" />
                        <Label Text="Cria uma nova conversa para comeÃ§ar!"
                               FontSize="14"
                               TextColor="#606060"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </CollectionView.EmptyView>

            </CollectionView>
        </ScrollView>

    </Grid>

</ContentPage>
